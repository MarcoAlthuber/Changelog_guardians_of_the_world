name: Oznámenie releasu na Discord

on:
  release:
    types: [published]

jobs:
  oznam-na-discord:
    runs-on: ubuntu-latest
    steps:
      - name: Poslať správu na Discord
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d "$(jq -n --arg title "🚀 Nová verzia bola vydaná: ${{ github.event.release.tag_name }}" \
                        --arg name "${{ github.event.release.name }}" \
                        --arg body "${{ github.event.release.body }}" \
                        --arg timestamp "${{ github.event.release.published_at }}" \
                        '{
                          embeds: [{
                            title: $title,
                            description: "**📌 Názov:** " + $name + "\n\n📝 **Zoznam zmien:**\n" + $body,
                            color: 16753920,
                            timestamp: $timestamp
                          }]
                        }'
                  )" \
               ${{ secrets.DISCORD_WEBHOOK }}
